<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>QA Sentimentâ„¢ Rage Tool</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-slate-900 antialiased">

<section class="max-w-4xl mx-auto px-6 py-20 text-center">
  <h1 class="text-5xl font-extrabold mb-6">QA Sentimentâ„¢ Rage Tool</h1>
  <p class="text-slate-600 mb-6">Paste your boring QA test case and get brutally honest, profanity-filled output.</p>

  <textarea id="inputText" class="w-full h-40 p-6 border rounded-2xl mb-4" placeholder="Given the user is logged in..."></textarea>

  <div class="mb-4">
    <label for="rageLevel" class="mr-2">Rage Level (1â€“10):</label>
    <input type="number" id="rageLevel" min="1" max="10" value="5" class="border rounded p-1 w-16 text-center" />
  </div>

  <button id="rageButton" class="px-10 py-4 rounded-full font-semibold text-lg bg-red-600 text-white hover:bg-red-700 transition shadow-lg">
    Unleash Rage
  </button>

  <h2 class="text-2xl font-bold mt-10 mb-4">Output</h2>
  <pre id="outputText" class="whitespace-pre-wrap text-left bg-slate-100 p-6 rounded-2xl border min-h-[120px]"></pre>
</section>

<script>
const button = document.getElementById("rageButton");
const output = document.getElementById("outputText");

async function streamOutput(text) {
  output.textContent = "";
  for (let i = 0; i < text.length; i++) {
    output.textContent += text[i];
    await new Promise(r => setTimeout(r, 15)); // small delay for streaming effect
    output.scrollTop = output.scrollHeight;
  }
}

button.addEventListener("click", async () => {
  const input = document.getElementById("inputText").value;
  const rageLevel = document.getElementById("rageLevel").value;

  if(!input) return alert("Paste your test case first!");

  output.textContent = "ðŸ’¥ Unleashing rageâ€¦";
  button.disabled = true;

  try {
    const res = await fetch("https://qa-sentiment-api.mikeconjoice.workers.dev/", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text: input, rageLevel })
    });

    const data = await res.json();
    if(data.error) {
      output.textContent = `Error: ${data.error}`;
    } else {
      await streamOutput(data.result);
    }
  } catch(e) {
    output.textContent = `Network error: ${e}`;
  } finally {
    button.disabled = false;
  }
});
</script>

</body>
</html>
